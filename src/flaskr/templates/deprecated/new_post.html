{% extends 'new_index.html' %}

{% block header %}
  <h1>{% block title %}Post Management{% endblock %}</h1>
{% endblock %}

{% block content %}
<!--<link rel="stylesheet" href="../static/res/layui/css/layui.css" media="all">-->
    <canvas id="myCanvas" width="150px" height="500px" horizontalScrollPolicy="off"></canvas>
  <div style="position:absolute;left:90px;top:140px" class="layui-container">
  <form action="" method="post" enctype="multipart/form-data">
    <input type="text" id="title" name="title" required  lay-verify="required" placeholder="Please Enter the Relevant Information of The Post" autocomplete="off" class="layui-input">
     <div class="fly-column-right layui-hide-xs">
      <button type="submit" class="layui-btn" lay-filter="*" lay-submit>Search Post</button>
     </div>
  </form>
  </div>

<div style="position:absolute;left:90px;top:200px" class="layui-container">
<table class="layui-table">
  <thead>
    <tr>
      <th width="20" style="text-align:center">Post ID</th>
      <th width="100" style="text-align:center">User Nickname</th>
      <th width="100" style="text-align:center">Post Title</th>
      <th width="100" style="text-align:center">Post Time</th>
      <th width="100" style="text-align:center">TopPost State</th>
        <th width="100" style="text-align:center">TopPost Operation</th>
      <th width="1" style="text-align:center">Delete</th>
    </tr> 
  </thead>
  {% for post in posts %}
  <tbody>
    <tr>
      <td style="text-align:center">{{ post['id'] }}</td>
      <td style="text-align:center">{{ post['nickname'] }}</td>
      <td style="text-align:center">{{ post['title'] }}</td>
      <td style="text-align:center">{{ post['created'] }}</td>
        {% if post['is_top'] == 1 %}
            <td style="text-align:center">TopPost</td>
            <td style="text-align:center">
            <form action="{{ url_for('admin.TopPost', id=[post['id'],0]) }}" method="post">
                <button class="layui-btn layui-btn-normal layui-btn-xs"  lay-filter="*" lay-submit type="submit">Release TopPost State</button>
            </form>
            </td>
        {% else %}
            <td style="text-align:center">Not in a TopPost State</td>
            <td style="text-align:center">
            <form action="{{ url_for('admin.TopPost', id=[post['id'],1]) }}" method="post">
                <button class="layui-btn layui-btn-warm layui-btn-xs"  lay-filter="*" lay-submit type="submit">TopPost</button>
            </form>
            </td>
        {% endif %}
      <td style="text-align:center">
          <form action="{{ url_for('admin.DeletePost', id=post['id']) }}" method="post">
              <button class="layui-btn layui-btn-danger layui-btn-xs"  lay-filter="*" lay-submit type="submit">Delete Post</button>
          </form>
        <!--<button class="layui-btn layui-btn-sm layui-btn-danger" href="{{ url_for('admin.DeletePost', id=post['id']) }}">
          <i class="layui-icon">&#xe640;</i>
        </button>-->
      </td>
    </tr>
  </tbody>
  {% endfor %}
</table>
<br>
    <p style="text-align:center"><span style="color:#c2c2c2">CatEatPad</span></p>
<br><br>
  </div>
</div>
<script>
  var cav = document.getElementById('myCanvas');
  var w = window.screen.availWidth;
  var h = window.screen.availHeight;
  var yPositions = Array(300).join(0).split('');
  var ctx = cav.getContext('2d');
  var draw = function(){
    ctx.fillStyle = 'rgba(57,61,73,1)';
    ctx.fillRect(0,0,w,h*1.2);
    ctx.fillStyle = 'rgba(95,184,120,1)';
    ctx.font = '20px';
    yPositions.map(function(y,index){
      text = String.fromCharCode(1e2+Math.random()*330);
      x = index*10;
      cav.getContext('2d').fillText(text,x,y);
      if(y>Math.random()*1e4){
        yPositions[index]=0;
      }else{
        yPositions[index]=y+10;
      }

    });
  }
  cav.setAttribute("width",screen.availWidth);
  cav.setAttribute("height",screen.availHeight*1.2);
  setInterval('draw()',20);
</script>
{% endblock %}

